import csv
from pathlib import Path

from procedure import Procedure

class WriteToCSV(Procedure):
    def run(self, ctx):
        with open(ctx.dest, "w", newline='') as fd:
            writer = csv.writer(fd, delimiter=',')

            writer.writerow(ctx.headers)
            for row in ctx.data:
                writer.writerow(row)

        return ctx

